// Fonts

// Bootstrap
@import '~bootstrap/scss/bootstrap';

// Font Awesome
@import '~font-awesome/scss/font-awesome';

@import "header";

// TODO Temporary fix of Menu Search
#header > .container {
    position: relative;
}

main#main {

    @include make-container();
    @include make-container-max-widths();

    position: relative;
    margin-top: 2em;
    margin-bottom: 2em;

    > section.pagination {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        margin-bottom: 2em;

        @include media-breakpoint-down(xs) {
            .page-link {
                padding: 1.25vw;
            }
        }
    }
}

footer#footer {

    @include make-container();
    @include make-container-max-widths();

    margin-top: 2em;
    border-top: 1px solid #ddd;

    > nav {

        @include make-row();

        margin-top: 2rem;

        > section.main {
            @include make-col-ready();
            @include media-breakpoint-up(lg) {
                @include make-col(4);
            }
        }

        > section.subscriptions {
            @include make-col-ready();
            @include media-breakpoint-up(lg) {
                @include make-col(8);
            }
        }
    }

    > section.copyright {

        @include make-row();

        margin-top: 1rem;

        > p {
            @include make-col-ready();
            @include make-col(12);

            text-align: right;
            font-size: 0.8rem;
        }
    }
}

article {

    @include make-row();
    margin-bottom: 2rem;

    > header {

        @include make-col-ready();
        @include make-col(12);

        border-bottom: 1px solid #ddd;
        margin-bottom: 1rem;

        > picture {
            float: left;
            width: 8rem;
            height: 8rem;
            margin-right: 1rem;
            margin-bottom: 0.5rem;
            object-fit: contain;
            text-align: center;

            > img {
                max-width: 100%;
                max-height: 100%;
                border: 1px solid #ccc;
            }
        }

        > h2 {
            font-size: 1.3rem;
        }
    }

    &.book {

        > header {

            > h1 {
                font-size: 2rem;
                overflow: hidden;
                display: -webkit-box;
                -webkit-line-clamp: 1;
                -webkit-box-orient: vertical;
                text-overflow: ellipsis;
            }
        }
    }

    > picture.abridge {

        > img {
            display: block;
            object-fit: cover;
            width: 100%;
        }
    }

    > section.abridge {

        > .text {
            overflow: hidden;
            display: -webkit-box;
            -webkit-box-orient: vertical;
            text-overflow: ellipsis;
        }
    }

    &.wide {

        > picture.abridge {
            @include make-col-ready();

            @include media-breakpoint-down(xs) {
                max-width: 90%;
                margin: 1em auto;
            }
            @include media-breakpoint-up(sm) {
                @include make-col(4);
            }
            @include media-breakpoint-up(lg) {
                @include make-col(3);
            }

            > img {
                @include media-breakpoint-up(xs) {
                    height: 8em;
                }
                @include media-breakpoint-up(sm) {
                    height: 10em;
                }
            }
        }

        > section.abridge {
            @include make-col-ready();

            @include media-breakpoint-up(sm) {
                @include make-col(8);
            }
            @include media-breakpoint-up(lg) {
                @include make-col(5);
            }

            > .text {
                -webkit-line-clamp: 4;
            }
        }
    }

    &.author {

        @include media-breakpoint-down(xs) {
            // HACK but it works...
            display: block !important;
        }

        @include media-breakpoint-up(sm) {
            margin-bottom: 3em;
        }

        > picture.abridge {
            @include media-breakpoint-down(xs) {
                float: left;
                margin: 0 1em;
            }
            @include media-breakpoint-up(sm) {
                @include make-col-ready();
                @include make-col(3);
            }
            @include media-breakpoint-up(lg) {
                @include make-col(2);
            }

            > img {
                display: block;
                width: 7em;
                height: 7em;
                max-width: 25vw;
                max-height: 25vw;

                @include media-breakpoint-up(md) {
                    width: 7.5em;
                    height: 7.5em;
                }
                @include media-breakpoint-up(lg) {
                    width: 8em;
                    height: 8em;
                }
                @include media-breakpoint-up(xl) {
                    width: 9em;
                    height: 9em;
                }
            }
        }

        > section.abridge {
            @include make-col-ready();

            > .text {
                -webkit-line-clamp: 3;
            }

            @include media-breakpoint-up(xs) {
                @include make-col(12);
                margin-bottom: 1em;
            }

            @include media-breakpoint-up(sm) {
                @include make-col(9);
            }

            @include media-breakpoint-up(lg) {
                @include make-col(6);

                > .text {
                    -webkit-line-clamp: 4;
                }
            }
        }

        > section.body > picture {
            display: block;
            float: left;
            margin: .25em 1.5em 1em 0;

            > img {
                width: 10em;
                max-width: 25vw;
                max-height: 25vw;
                height: auto;
            }
        }
    }

    > section.body {
        @include make-col-ready();
        @include media-breakpoint-up(lg) {
            @include make-col(8);
        }

        > picture {

            display: flex;
            max-height: 30em;

            > img {
                display: block;
                width: 100%;
                height: auto;
                object-fit: contain;
            }
        }

        > p img, > picture, .embed-responsive {
            max-width: 90%;
            margin-left: auto;
            margin-right: auto;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }

        // This is a quick hack to handle old news postings referencing the
        // gallery with links around images.
        > p > a[href^="/gallery/"] {
            display: inline-block;
            width: 100%;
            text-align: center;
        }

        > p > img {
            display: block;
        }

        img.media-object {
            margin-right: 1rem;
        }

        // TODO Temporary fix for residents
        .media {
            margin-bottom: 1rem;
            p:last-child {
                margin-bottom: 0;
            }
        }
    }

    > aside {
        @include make-col-ready();
        @include media-breakpoint-up(lg) {
            @include make-col(4);
        }
        text-align: right;
        color: #555;

        > .buttons {
            margin-top: 1rem;
        }
    }

    &.subpage {

        > nav {
            @include make-col-ready();
            @include media-breakpoint-up(md) {
                @include make-col(3);
            }
        }

        > section.body {
            @include make-col-ready();
            @include media-breakpoint-up(md) {
                @include make-col(9);
            }
            h1:first-child {
                margin-bottom: 1.5rem;
                padding-bottom: 0.5rem;
                border-bottom: 1px solid #ddd;
            }
        }
    }
}

.book-cart {

    > section {
        margin-top: 1rem;
        margin-bottom: 2rem;

        > h2 {
            border-bottom: 1px solid #ddd;
            margin-bottom: 1rem;
        }
    }

    > section.selection {
        td {
            vertical-align: middle;
        }
        td.title {
            > img {
                float: left;
                margin-right: 0.5rem;
                margin-bottom: 0.25rem;
                width: 2.5rem;
                max-height: 4rem;
                object-fit: contain;
                object-position: top;
            }

            > h1 {
                font-size: 1.5rem;
                overflow: hidden;
                display: -webkit-box;
                -webkit-line-clamp: 1;
                -webkit-box-orient: vertical;
                text-overflow: ellipsis;
            }

            > h2 {
                font-size: 1.2rem;
            }
        }
        td.quantity {
            max-width: 8rem;
            input {
                max-width: 5rem;
            }
        }
        td.remove {
            max-width: 5rem;
        }
    }
}

// Styles from new/components/ui/*
@import "ui";

@import "search";
